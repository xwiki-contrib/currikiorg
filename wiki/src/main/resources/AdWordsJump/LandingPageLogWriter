<?xml version="1.0" encoding="UTF-8"?>

<xwikidoc>
<web>AdWordsJump</web>
<name>LandingPageLogWriter</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>0</translation>
<parent></parent>
<creator>XWiki.panjl</creator>
<author>XWiki.dward</author>
<customClass></customClass>
<contentAuthor>XWiki.dward</contentAuthor>
<creationDate>1227154649000</creationDate>
<date>1234891233000</date>
<contentUpdateDate>1234891233000</contentUpdateDate>
<version>5.1</version>
<title></title>
<template></template>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment></comment>
<minorEdit>false</minorEdit>
<syntaxId>xwiki/1.0</syntaxId>
<object>
<class>
<name>XWiki.TagClass</name>
<customClass></customClass>
<customMapping></customMapping>
<defaultViewSheet></defaultViewSheet>
<defaultEditSheet></defaultEditSheet>
<defaultWeb></defaultWeb>
<nameField></nameField>
<validationScript></validationScript>
<tags>
<cache>0</cache>
<displayType>select</displayType>
<multiSelect>1</multiSelect>
<name>tags</name>
<number>1</number>
<prettyName>Tags</prettyName>
<relationalStorage>1</relationalStorage>
<separator> </separator>
<separators> ,|</separators>
<size>30</size>
<unmodifiable>0</unmodifiable>
<values></values>
<classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
</tags>
</class>
<name>AdWordsJump.LandingPageLogWriter</name>
<number>0</number>
<className>XWiki.TagClass</className>
<property>
<tags/>
</property>
</object>
<content>{pre}
#set($rurl = "/xwiki/bin/view/Search/")
#set($jumpname = $request.jumpname)
#set($txt = $request.txt)
#if($jumpname &amp;&amp; $txt)
    #set($inform = "No")
    #set($email = "No e-mail")
    #if($request.inform &amp;&amp; $request.inform == "1")
        #set($inform = "Yes")
        #set($email = $request.email)
    #end
    #set($searchTime = $xwiki.formatDate($util.date,"yyyy-MM-dd HH:mm:ss.S"))
    ## use programming rights instead of view rights
    #set($log_page = "AdWordsLog." +$jumpname+"Log")
    #set($log_doc=$xwiki.xWiki.getDocument($log_page,$context.context))
    #if($log_doc.isNew())
        $log_doc.setContent('#includeForm("AdWordsJump.LandingPageLogTemplate")')
        $log_doc.setParent('AdWordsJump.LandingPageLog')
        $xwiki.xWiki.saveDocument($log_doc,$context.context)
    #end
    #set($log_infos=$util.getArrayList())
    ## does not write true true true true to page
    $!log_infos.add(0,$!searchTime)
    $!log_infos.add(1,$!txt)
    $!log_infos.add(2,$!inform)
    $!log_infos.add(3,$!email)
    $xwiki.activitystream.addDocumentActivityEvent("AdWordsJump",$log_doc.newDocument($context.context),"Log",$log_doc.getName(),$log_infos)
    #set($txt_escaped = $request.txt_escaped)
    #set($subjectparent_escaped = $request.subjectparent_escaped)
    #set($subject_escaped = $request.subject_escaped)
    #if($txt_escaped &amp;&amp; $txt_escaped!="")
        #set($rurl = $rurl+"#o%3As%3Ds%253Aresource%5Ef%3Do%253Aresource%253Do%25253Aterms%25253Ds%2525253A"+$txt_escaped)
        #if($subjectparent_escaped &amp;&amp; $subjectparent_escaped!="")
            #set($rurl = $rurl+"%25255Esince%25253Ds%2525253A20080821%25255Eother%25253Ds%2525253A%25255Esubjectparent%25253Ds%2525253AFW_masterFramework."+$subjectparent_escaped+"%25255Esubject%25253Ds%2525253AFW_masterFramework.")
            #if($subject_escaped &amp;&amp; $subject_escaped!="")
                #set($rurl = $rurl+$subject_escaped+"%25255Ereview%25253Ds%2525253A%25255Elevel%25253Ds%2525253A%25255Elanguage%25253Ds%2525253A%25255Especial%25253Ds%2525253A%25255Eictprfx%25253Ds%2525253A%25255Eict%25253Ds%2525253A%255Egroup%253Do%25253Aterms%25253Ds%2525253Aenter%25252520search%25252520terms%25255Esince%25253Ds%2525253A20080821%25255Eother%25253Ds%2525253A%25255Esubjectparent%25253Ds%2525253A%25255Esubject%25253Ds%2525253A%25255Elevel%25253Ds%2525253A%25255Elanguage%25253Ds%2525253A%25255Epolicy%25253Ds%2525253A%255Emember%253Do%25253Aterms%25253Ds%2525253Aenter%25252520search%25252520terms%25255Esince%25253Ds%2525253A20080821%25255Eother%25253Ds%2525253A%25255Esubjectparent%25253Ds%2525253A%25255Esubject%25253Ds%2525253A%25255Emember_type%25253Ds%2525253A%25255Ecountry%25253Ds%2525253A%255Eblog%253Do%25253Aterms%25253Ds%2525253Aenter%25252520search%25252520terms%25255Esince%25253Ds%2525253A20080821%25255Eother%25253Ds%2525253A%255Ecurriki%253Do%25253Aterms%25253Ds%2525253Aenter%25252520search%25252520terms%25255Esince%25253Ds%2525253A20080821%25255Eother%25253Ds%2525253A%5Ep%3Do%253Aresource%253Do%25253Ac%25253Dn%2525253A0%25255Es%25253Dn%2525253A25%255Egroup%253Do%25253Ac%25253Dn%2525253A0%25255Es%25253Dn%2525253A25%255Emember%253Do%25253Ac%25253Dn%2525253A0%25255Es%25253Dn%2525253A25%255Eblog%253Do%25253Ac%25253Dn%2525253A0%25255Es%25253Dn%2525253A25%255Ecurriki%253Do%25253Ac%25253Dn%2525253A0%25255Es%25253Dn%2525253A25%5Et%3Ds%253Asearch-resource-tab%5Ea%3Do%253Aresource%253Do%25253Aa%25253Db%2525253A1")
            #else
                #set($rurl = $rurl+$subjectparent_escaped+"%25255Ereview%25253Ds%2525253A%25255Elevel%25253Ds%2525253A%25255Elanguage%25253Ds%2525253A%25255Especial%25253Ds%2525253A%25255Eictprfx%25253Ds%2525253A%25255Eict%25253Ds%2525253A%255Egroup%253Do%25253Aterms%25253Ds%2525253Aenter%25252520search%25252520terms%25255Esince%25253Ds%2525253A20080821%25255Eother%25253Ds%2525253A%25255Esubjectparent%25253Ds%2525253A%25255Esubject%25253Ds%2525253A%25255Elevel%25253Ds%2525253A%25255Elanguage%25253Ds%2525253A%25255Epolicy%25253Ds%2525253A%255Emember%253Do%25253Aterms%25253Ds%2525253Aenter%25252520search%25252520terms%25255Esince%25253Ds%2525253A20080821%25255Eother%25253Ds%2525253A%25255Esubjectparent%25253Ds%2525253A%25255Esubject%25253Ds%2525253A%25255Emember_type%25253Ds%2525253A%25255Ecountry%25253Ds%2525253A%255Eblog%253Do%25253Aterms%25253Ds%2525253Aenter%25252520search%25252520terms%25255Esince%25253Ds%2525253A20080821%25255Eother%25253Ds%2525253A%255Ecurriki%253Do%25253Aterms%25253Ds%2525253Aenter%25252520search%25252520terms%25255Esince%25253Ds%2525253A20080821%25255Eother%25253Ds%2525253A%5Ep%3Do%253Aresource%253Do%25253Ac%25253Dn%2525253A0%25255Es%25253Dn%2525253A25%255Egroup%253Do%25253Ac%25253Dn%2525253A0%25255Es%25253Dn%2525253A25%255Emember%253Do%25253Ac%25253Dn%2525253A0%25255Es%25253Dn%2525253A25%255Eblog%253Do%25253Ac%25253Dn%2525253A0%25255Es%25253Dn%2525253A25%255Ecurriki%253Do%25253Ac%25253Dn%2525253A0%25255Es%25253Dn%2525253A25%5Et%3Ds%253Asearch-resource-tab%5Ea%3Do%253Aresource%253Do%25253Aa%25253Db%2525253A1")
            #end
        #end
    #end
#end
{"rurl":"$rurl"}
{/pre}</content>
</xwikidoc>
